{"ast":null,"code":"import _toConsumableArray from\"/Users/Kuba/reTask/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _regeneratorRuntime from\"/Users/Kuba/reTask/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/Kuba/reTask/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/Kuba/reTask/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect}from\"react\";import{toast}from\"react-toastify\";export var useHttpRequest=function useHttpRequest(){var _ref;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),tasks=_useState2[0],setTasks=_useState2[1];var _useState3=useState(undefined),_useState4=_slicedToArray(_useState3,2),newTask=_useState4[0],setNewTask=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),newAddTask=_useState6[0],setnewAddTask=_useState6[1];var fetchData=function fetchData(){return(_ref=_ref||_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return fetch(\"\".concat(process.env.REACT_APP_API));case 3:response=_context.sent;_context.next=6;return response.json();case 6:data=_context.sent;setTasks(data);_context.next=13;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](0);console.error(\"Wystąpił błąd z pobieraniem danych\",_context.t0);case 13:case\"end\":return _context.stop();}},_callee,null,[[0,10]]);}))).apply(this,arguments);};var handleAddTask=function handleAddTask(){var newTaskObject={title:newTask,id:Date.now(),completed:false};if((newTask===null||newTask===void 0?void 0:newTask.trim())!==\"\"){fetch(\"\".concat(process.env.REACT_APP_API),{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(newTaskObject)}).then(function(response){if(response.ok){toast.success(\"Dodano nowe zadanie\",{position:\"top-right\",autoClose:2000,hideProgressBar:false,closeOnClick:true,pauseOnHover:true,draggable:true,progress:undefined,theme:\"light\"});fetchData();setNewTask(\"\");setnewAddTask(newTaskObject);}else{throw new Error(\"Nie udało się dodac zadania\");}}).catch(function(error){toast.error(\"Wyst\\u0105pi\\u0142 b\\u0142\\u0105d podczas dodawania zadania: \".concat(error.message),{position:\"top-right\",autoClose:2000,hideProgressBar:false,closeOnClick:true,pauseOnHover:true,draggable:true,progress:undefined,theme:\"light\"});});}};var handleRemoveTask=function handleRemoveTask(id){fetch(\"\".concat(process.env.REACT_APP_API,\"/\").concat(id),{method:\"DELETE\",headers:{\"Content-Type\":\"application/json\"}}).then(function(response){if(response.ok){toast.success(\"Usuni\\u0119to zadanie\",{position:\"top-right\",autoClose:2000,hideProgressBar:false,closeOnClick:true,pauseOnHover:true,draggable:true,progress:undefined,theme:\"light\"});fetchData();}else{throw new Error(\"Nie udało się usunąć zadania\");}}).catch(function(error){// Obsługa błędów\nconsole.error(\"Błąd podczas usuwania zadania:\",error);toast.error(\"Wyst\\u0105pi\\u0142 b\\u0142\\u0105d podczas usuwania zadania: \".concat(error.message),{position:\"top-right\",autoClose:2000,hideProgressBar:false,closeOnClick:true,pauseOnHover:true,draggable:true,progress:undefined,theme:\"light\"});});};var handleToggleTask=function handleToggleTask(id){var updatedTasks=_toConsumableArray(tasks);var task=updatedTasks.find(function(t){return t.id===id;});if(task){task.completed=!task.completed;fetch(\"\".concat(process.env.REACT_APP_API,\"/\").concat(id),{method:\"PATCH\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({completed:task.completed})// Przesyłamy aktualny stan\n}).then(function(response){if(response.ok){if(task.completed){toast.success(\"Brawo wykona\\u0142e\\u015B zadanie\",{position:\"top-right\",autoClose:2000,hideProgressBar:false,closeOnClick:true,pauseOnHover:true,draggable:true,progress:undefined,theme:\"light\"});}fetchData();setTasks(updatedTasks);}else{throw new Error(\"Nie udało się usunąć zadania\");}}).catch(function(error){console.error(\"Błąd podczas zmiany statusu zadania:\",error);});}};useEffect(function(){fetchData();},[]);return{newAddTask:newAddTask,handleAddTask:handleAddTask,handleRemoveTask:handleRemoveTask,handleToggleTask:handleToggleTask,fetchData:fetchData,tasks:tasks,newTask:newTask,setNewTask:setNewTask};};","map":{"version":3,"names":["useState","useEffect","toast","useHttpRequest","_ref","_useState","_useState2","_slicedToArray","tasks","setTasks","_useState3","undefined","_useState4","newTask","setNewTask","_useState5","_useState6","newAddTask","setnewAddTask","fetchData","_asyncToGenerator","_regeneratorRuntime","mark","_callee","response","data","wrap","_callee$","_context","prev","next","fetch","concat","process","env","REACT_APP_API","sent","json","t0","console","error","stop","apply","arguments","handleAddTask","newTaskObject","title","id","Date","now","completed","trim","method","headers","body","JSON","stringify","then","ok","success","position","autoClose","hideProgressBar","closeOnClick","pauseOnHover","draggable","progress","theme","Error","catch","message","handleRemoveTask","handleToggleTask","updatedTasks","_toConsumableArray","task","find","t"],"sources":["/Users/Kuba/reTask/client/src/components/hooks/httpRequest.ts"],"sourcesContent":["import { useState, useEffect } from \"react\";\nimport { TaskTypes } from \"../types/taskResult.type\";\nimport { toast } from \"react-toastify\";\n\nexport const useHttpRequest = () => {\n  const [tasks, setTasks] = useState<TaskTypes[]>([]);\n  const [newTask, setNewTask] = useState<string | undefined>(undefined);\n  const [newAddTask, setnewAddTask] = useState<TaskTypes>();\n\n  const fetchData = async () => {\n    try {\n      const response = await fetch(`${process.env.REACT_APP_API}`);\n      const data = await response.json();\n      setTasks(data);\n    } catch (error) {\n      console.error(\"Wystąpił błąd z pobieraniem danych\", error);\n    }\n  };\n\n  const handleAddTask = () => {\n    const newTaskObject = {\n      title: newTask,\n      id: Date.now(),\n      completed: false,\n    };\n    if (newTask?.trim() !== \"\") {\n      fetch(`${process.env.REACT_APP_API}`, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify(newTaskObject),\n      })\n        .then((response) => {\n          if (response.ok) {\n            toast.success(`Dodano nowe zadanie`, {\n              position: \"top-right\",\n              autoClose: 2000,\n              hideProgressBar: false,\n              closeOnClick: true,\n              pauseOnHover: true,\n              draggable: true,\n              progress: undefined,\n              theme: \"light\",\n            });\n\n            fetchData();\n            setNewTask(\"\");\n            setnewAddTask(newTaskObject);\n          } else {\n            throw new Error(\"Nie udało się dodac zadania\");\n          }\n        })\n        .catch((error) => {\n          toast.error(\n            `Wystąpił błąd podczas dodawania zadania: ${error.message}`,\n            {\n              position: \"top-right\",\n              autoClose: 2000,\n              hideProgressBar: false,\n              closeOnClick: true,\n              pauseOnHover: true,\n              draggable: true,\n              progress: undefined,\n              theme: \"light\",\n            }\n          );\n        });\n    }\n  };\n\n  const handleRemoveTask = (id: number) => {\n    fetch(`${process.env.REACT_APP_API}/${id}`, {\n      method: \"DELETE\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n    })\n      .then((response) => {\n        if (response.ok) {\n          toast.success(`Usunięto zadanie`, {\n            position: \"top-right\",\n            autoClose: 2000,\n            hideProgressBar: false,\n            closeOnClick: true,\n            pauseOnHover: true,\n            draggable: true,\n            progress: undefined,\n            theme: \"light\",\n          });\n\n          fetchData();\n        } else {\n          throw new Error(\"Nie udało się usunąć zadania\");\n        }\n      })\n      .catch((error) => {\n        // Obsługa błędów\n        console.error(\"Błąd podczas usuwania zadania:\", error);\n        toast.error(\n          `Wystąpił błąd podczas usuwania zadania: ${error.message}`,\n          {\n            position: \"top-right\",\n            autoClose: 2000,\n            hideProgressBar: false,\n            closeOnClick: true,\n            pauseOnHover: true,\n            draggable: true,\n            progress: undefined,\n            theme: \"light\",\n          }\n        );\n      });\n  };\n\n  const handleToggleTask = (id: number) => {\n    const updatedTasks = [...tasks];\n    const task = updatedTasks.find((t) => t.id === id);\n    if (task) {\n      task.completed = !task.completed;\n\n      fetch(`${process.env.REACT_APP_API}/${id}`, {\n        method: \"PATCH\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify({ completed: task.completed }), // Przesyłamy aktualny stan\n      })\n        .then((response) => {\n          if (response.ok) {\n            if (task.completed) {\n              toast.success(`Brawo wykonałeś zadanie`, {\n                position: \"top-right\",\n                autoClose: 2000,\n                hideProgressBar: false,\n                closeOnClick: true,\n                pauseOnHover: true,\n                draggable: true,\n                progress: undefined,\n                theme: \"light\",\n              });\n            }\n\n            fetchData();\n            setTasks(updatedTasks);\n          } else {\n            throw new Error(\"Nie udało się usunąć zadania\");\n          }\n        })\n\n        .catch((error) => {\n          console.error(\"Błąd podczas zmiany statusu zadania:\", error);\n        });\n    }\n  };\n\n  useEffect(() => {\n    fetchData();\n  }, []);\n\n  return {\n    newAddTask,\n    handleAddTask,\n    handleRemoveTask,\n    handleToggleTask,\n    fetchData,\n    tasks,\n    newTask,\n    setNewTask,\n  };\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}